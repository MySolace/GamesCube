diff --git a/command.c b/command.c
index efa3ae8..a0888c7 100644
--- a/command.c
+++ b/command.c
@@ -630,6 +630,7 @@ static void command_stdin_poll(command_t *handle)
 
 bool command_poll(command_t *handle)
 {
+   memset(handle->state, 0, sizeof(handle->state));
 #if defined(HAVE_NETWORKING) && defined(HAVE_NETWORK_CMD)
 #ifdef HAVE_COMMAND
    command_network_poll(handle);
